<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Inno3-Pro Arduino Library: InnoPro_Serial.ino</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="PI_LOGO.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Inno3-Pro Arduino Library
   </div>
   <div id="projectbrief">Document Version 1.1   -   May 19, 2017</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_inno_pro__serial_8ino-example.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">InnoPro_Serial.ino</div>  </div>
</div><!--header-->
<div class="contents">
<p>This is an example of how to use the library.</p>
<h1>Serial Application: </h1>
<div class="image">
<img src="InnoPro_Serial.png" alt="InnoPro_Serial.png"/>
</div>
<p><br />
 </p><h1>Code: </h1>
<div class="fragment"><div class="line">/**</div><div class="line">  Inno3 Pro Serial Application Source File</div><div class="line"></div><div class="line">  Company:    Power Integrations</div><div class="line"></div><div class="line">  Summary:    This demonstration file uses SerialEvent Arduino Example and Inno Pro Library </div><div class="line">              It Checks for the incoming Serial Data (Command Codes) and Processes</div><div class="line">              the user inputs to Control the Inno3-Pro via I2C</div><div class="line"></div><div class="line">  Author:     Clomiferds M. Sales  </div><div class="line"></div><div class="line">  Date:       April 30, 2017</div><div class="line">  </div><div class="line">*/</div><div class="line"></div><div class="line"></div><div class="line">// Header Files</div><div class="line">#include &lt;Config.h&gt;</div><div class="line">#include &lt;Drv_i2c.h&gt;</div><div class="line">#include &lt;Drv_Rtc.h&gt;</div><div class="line">#include &lt;InnoPro.h&gt;</div><div class="line"></div><div class="line"></div><div class="line">// Variables for grabbing the serial input</div><div class="line">String InnoProString = &quot;&quot;;</div><div class="line">float inputFloat;</div><div class="line">boolean stringComplete = false;</div><div class="line"></div><div class="line"></div><div class="line">// Main Loop Variable Initialization </div><div class="line">static float fVolts = 5;                 //Initialize Voltage at 5V</div><div class="line">static float fAmps = 5;                  //Initialize Constant Current at 5A </div><div class="line">static float fCableDropComp = 300;       //Initialize Cable Drop Compensation to 300mv</div><div class="line">static float fVoltPeak = 7;              //Initialize Voltage Peak at 7V </div><div class="line">static float fVbusEn = 1;                //Initialize Vbus Enable to at ON        </div><div class="line"></div><div class="line"></div><div class="line">// Library Instance - Needed to call Classes</div><div class="line">InnoPro_Application InnoProApp;</div><div class="line"></div><div class="line"></div><div class="line">void setup() {</div><div class="line"></div><div class="line">  // initialize digital pin LED_BUILTIN as an output.</div><div class="line">  pinMode(LED_BUILTIN, OUTPUT);  </div><div class="line">  digitalWrite(LED_BUILTIN, HIGH);   // turn the LED on </div><div class="line">    </div><div class="line">  // Initialize serial</div><div class="line">  Serial.begin(9600);  </div><div class="line"></div><div class="line">  // reserve 10 bytes for the inputString:</div><div class="line">  InnoProString.reserve(10);</div><div class="line">  </div><div class="line">  // Initial Message</div><div class="line">  Serial.println(F(&quot;InnoPro Serial Application&quot;));   //F( ) -Stores Strings on the Flash Memory to Optimize SRAM</div><div class="line">  Serial.print(&quot;\n&quot;);    </div><div class="line">  Serial.println(F(&quot;Command Codes: INIT, VI, CDC, VKP, VBEN, RDVOLTS, RDAMPS, STATUS&quot;)); </div><div class="line"></div><div class="line">  /*</div><div class="line">   * User Instructions:</div><div class="line">   </div><div class="line">    PROCEDURE:</div><div class="line">    Input the Command Code, then Input the Value(s)</div><div class="line">    Command Codes are Case Sensitive</div><div class="line"></div><div class="line">  </div><div class="line">    EXAMPLE: (Voltage and Current)</div><div class="line">    &quot;Input VI and Send&quot;</div><div class="line">    &quot;Input 5 and Send (This Means 5V)&quot;</div><div class="line">    &quot;Input 3 and Send (This Means 3A)&quot;</div><div class="line">    </div><div class="line">   */</div><div class="line">  </div><div class="line">  Serial.print(&quot;\n&quot;);  </div><div class="line">  Serial.println(F(&quot;*****************************************************************&quot;));</div><div class="line">  Serial.print(&quot;\n&quot;);  </div><div class="line"></div><div class="line">  //Run Initialization at Start Up</div><div class="line">  InnoProApp.InnoPro_Initialization();   </div><div class="line">}</div><div class="line"></div><div class="line">void loop()</div><div class="line">{</div><div class="line"></div><div class="line">      //Check for Serial Events</div><div class="line">      serialEvent();</div><div class="line"></div><div class="line">      //Commands Received</div><div class="line">      if(stringComplete)</div><div class="line">      {</div><div class="line">        InnoProSerial_State();                    // Command States , Processes the Serial Inputs</div><div class="line">        stringComplete = false;                   // Clear the input boolean               </div><div class="line">        InnoProString = &quot;&quot;;                       // Clear the input string              </div><div class="line">      }    </div><div class="line">   </div><div class="line"></div><div class="line">      //Library Call in the Mainloop</div><div class="line">      InnoProApp.InnoPro_Write_VI(fVolts,fAmps);                    //Set Voltage and current</div><div class="line">      InnoProApp.InnoPro_Write_Cable_Drop_Comp(fCableDropComp);     //Set Cable Drop Compesation                    </div><div class="line">      InnoProApp.InnoPro_Write_Volt_Peak(fVoltPeak);                //Set Constant Output Power Knee Voltage</div><div class="line">      InnoProApp.InnoPro_Vbus_Switch_Control(fVbusEn);              //Set Vbus Enable</div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">// Catch All Serial Commands</div><div class="line">void serialEvent() </div><div class="line">{</div><div class="line">  if (Serial.available()) {</div><div class="line">    // get the new byte:</div><div class="line">    char inChar = (char)Serial.read();</div><div class="line">    // add it to the inputString:</div><div class="line">    InnoProString += inChar;</div><div class="line">    // if the incoming character is a newline, set a flag</div><div class="line">    // so the main loop can do something about it:</div><div class="line">    if (inChar == &#39;\n&#39;) {</div><div class="line">      stringComplete = true;</div><div class="line">    }</div><div class="line">  }</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">//Process All Serial Commands and Configures Inno Pro based on the Inputs</div><div class="line">void InnoProSerial_State (void)</div><div class="line">{</div><div class="line">         //Temporary  Variables</div><div class="line">         uint16_t u16TempReadValue = 0;</div><div class="line">         uint16_t u16TempReadLsb = 0;</div><div class="line">         uint16_t u16TempReadMsb = 0;         </div><div class="line">         static float fTempVolts = 5;   </div><div class="line">         float fConvertedValue = 0;             </div><div class="line">         </div><div class="line">          //Inno Pro Command States</div><div class="line">          static enum { STATE_CMD_CODE,</div><div class="line">                        STATE_VOLTS, </div><div class="line">                        STATE_AMPS, </div><div class="line">                        STATE_CDC,</div><div class="line">                        STATE_VKP,</div><div class="line">                        STATE_VBEN,</div><div class="line">                        STATE_INIT</div><div class="line">                      }SerialState_e;</div><div class="line">                        </div><div class="line">          switch(SerialState_e)</div><div class="line">          {</div><div class="line">      </div><div class="line">            case STATE_CMD_CODE:</div><div class="line">                              </div><div class="line">                  Serial.print(F(&quot;Inno Pro Command Code: &quot;));                  // Print the data to serial    </div><div class="line">      </div><div class="line">                  if (InnoProString == &quot;VI\n&quot;)</div><div class="line">                  {  </div><div class="line">                     Serial.print(InnoProString);            </div><div class="line">                     SerialState_e = STATE_VOLTS;                                             </div><div class="line">                  } </div><div class="line">                  else if (InnoProString == &quot;CDC\n&quot;)</div><div class="line">                  {  </div><div class="line">                     Serial.print(InnoProString);             </div><div class="line">                     SerialState_e = STATE_CDC;                                            </div><div class="line">                  }  </div><div class="line">                  else if (InnoProString == &quot;VKP\n&quot;)</div><div class="line">                  {  </div><div class="line">                     Serial.print(InnoProString);              </div><div class="line">                     SerialState_e = STATE_VKP;                                            </div><div class="line">                  }     </div><div class="line">                  else if (InnoProString == &quot;VBEN\n&quot;)</div><div class="line">                  {  </div><div class="line">                     Serial.print(InnoProString);            </div><div class="line">                     SerialState_e = STATE_VBEN;                                            </div><div class="line">                  }    </div><div class="line">                  else if (InnoProString == &quot;INIT\n&quot;)</div><div class="line">                  {  </div><div class="line">                     Serial.print(InnoProString);    </div><div class="line">                     InnoProApp.InnoPro_Vbus_Switch_Control(0);               //Turn Off Vbus Switch   </div><div class="line">                     delay(50);      </div><div class="line">                     InnoProApp.InnoPro_Initialization();                     //Disable Watch Dog</div><div class="line"></div><div class="line">                     //Set Values</div><div class="line">                     fVolts = 5;</div><div class="line">                     fAmps = 5;</div><div class="line">                     fCableDropComp = 300;</div><div class="line">                     fVoltPeak = 7;</div><div class="line">                     fVbusEn = 1;</div><div class="line">   </div><div class="line">                     delay(50); </div><div class="line">                     InnoProApp.InnoPro_Vbus_Switch_Control(fVbusEn);         //Turn on Vbus</div><div class="line">                     </div><div class="line">                     //Send Value to Serial Monitor  </div><div class="line">                     Serial.print(F(&quot;Voltage Setting: &quot;));                       Serial.print(fVolts);             Serial.print(F(&quot; V&quot;));     Serial.print(&quot;\n&quot;);    </div><div class="line">                     Serial.print(F(&quot;Constant Current Setting:: &quot;));             Serial.print(fAmps);              Serial.print(F(&quot; A&quot;));     Serial.print(&quot;\n&quot;);   </div><div class="line">                     Serial.print(F(&quot;Cable Drop Compensation: &quot;));               Serial.print(fCableDropComp);     Serial.print(F(&quot; mV&quot;));    Serial.print(&quot;\n&quot;);    </div><div class="line">                     Serial.print(F(&quot;Constant Output Power Knee Voltage: &quot;));    Serial.print(fVoltPeak);          Serial.print(F(&quot; V&quot;));     Serial.print(&quot;\n&quot;);         </div><div class="line">                     Serial.print(F(&quot;Series Bus Switch Control: &quot;));             Serial.print(fVbusEn);            Serial.print(F(&quot; ON&quot;));    Serial.print(&quot;\n&quot;);   </div><div class="line">                     Serial.print(&quot;\n&quot;);  </div><div class="line"></div><div class="line">                                                                     </div><div class="line">                  }   </div><div class="line">                  else if (InnoProString == &quot;RDVOLTS\n&quot;)</div><div class="line">                  {  </div><div class="line">                     Serial.print(InnoProString);</div><div class="line">                     u16TempReadValue = InnoProApp.InnoPro_Telemetry(INNOPRO_READ1);                    // Read1, Reg_CV</div><div class="line">                     </div><div class="line">                     Serial.print(F(&quot;Output Voltage Set-Point: &quot;));                                     // Print the data to serial                      </div><div class="line">                     Serial.print(&quot;\n&quot;);        </div><div class="line">                     Serial.print(F(&quot;HEX       : &quot;));             Serial.print(u16TempReadValue,HEX);         Serial.print(F(&quot;(LSB,MSB)&quot;));  // Print Hex Equivalent </div><div class="line"></div><div class="line">                     //Reg_CV Conversion </div><div class="line">                     u16TempReadLsb = (u16TempReadValue &amp; 0xFF) &lt;&lt; 8;                               //Extract LSB  - Example  5V -&gt; F401 Hex,  Returns 100</div><div class="line">                     u16TempReadMsb = (u16TempReadValue &amp; 0xFF00) &gt;&gt; 8;                             //Extract MSB  - Example  5V -&gt; F401 Hex,  Returns F4</div><div class="line">                     u16TempReadValue = (u16TempReadLsb | u16TempReadMsb);                          //Merges LSB and MSB  - Example  5V -&gt; F401 Hex,  Returns 1F4</div><div class="line"></div><div class="line">                     Serial.print(&quot;\n&quot;);                </div><div class="line">                     Serial.print(F(&quot;DECIMAL   : &quot;));             Serial.print(u16TempReadValue,DEC);         // Print Decimal Equivalent</div><div class="line"></div><div class="line">                     fConvertedValue = (float) (u16TempReadValue / INNOPRO_CV_SET_PT_MULT );                  // Implement CV multiplier</div><div class="line">                       </div><div class="line">                     Serial.print(&quot;\n&quot;);        </div><div class="line">                     Serial.print(F(&quot;CONVERTED : &quot;));            Serial.print(fConvertedValue,2);   Serial.print(F(&quot; V&quot;));// Print Converted Equivalent</div><div class="line"></div><div class="line">                     </div><div class="line">                     //Next Line</div><div class="line">                     Serial.print(&quot;\n&quot;);                             </div><div class="line">                     Serial.print(&quot;\n&quot;);                                                                     </div><div class="line">                  } </div><div class="line">                  else if (InnoProString == &quot;RDAMPS\n&quot;)</div><div class="line">                  {  </div><div class="line">                     Serial.print(InnoProString);</div><div class="line">                     u16TempReadValue = InnoProApp.InnoPro_Telemetry(INNOPRO_READ6);                          // Read6, Reg_MEASURED_I</div><div class="line">                     </div><div class="line">                     Serial.print(F(&quot;Measured Output Current: &quot;));                                            // Print the data to serial                      </div><div class="line">                     Serial.print(&quot;\n&quot;);        </div><div class="line">                     Serial.print(F(&quot;HEX       : &quot;));             Serial.print(u16TempReadValue,HEX);         // Print Hex Equivalent</div><div class="line"></div><div class="line">                     //Reg_MEASURED_I Conversion </div><div class="line">                     u16TempReadLsb = (u16TempReadValue &amp; 0xFF00) &gt;&gt; 8;                                       //Extract MSB  - Example  3A -&gt; 3A64 Hex,  Returns 3A                                         </div><div class="line">                     Serial.print(&quot;\n&quot;);                </div><div class="line">                     Serial.print(F(&quot;LSB       : &quot;));             Serial.print(u16TempReadLsb,HEX);           // Print HEX Equivalent                     </div><div class="line"></div><div class="line">                     //Decimal Equivalent</div><div class="line">                     u16TempReadValue =  u16TempReadLsb;     </div><div class="line">                     Serial.print(&quot;\n&quot;);                </div><div class="line">                     Serial.print(F(&quot;DECIMAL   : &quot;));             Serial.print(u16TempReadValue,DEC);         // Print Decimal Equivalent</div><div class="line"></div><div class="line">                     //(0.25mV=32mV/128, where 32mV is the full range Rsense voltage, 128 is the ADC full range)                                  </div><div class="line">                     fConvertedValue = (float)(( u16TempReadValue * 0.25) / INNOPRO_RSENSE);                  // Convert Value</div><div class="line">                       </div><div class="line">                     Serial.print(&quot;\n&quot;);        </div><div class="line">                     Serial.print(F(&quot;CONVERTED : &quot;));            Serial.print(fConvertedValue,2);   Serial.print(F(&quot; A&quot;));// Print Converted Equivalent</div><div class="line"></div><div class="line">                     </div><div class="line">                     //Next Line</div><div class="line">                     Serial.print(&quot;\n&quot;);                             </div><div class="line">                     Serial.print(&quot;\n&quot;);                                                                     </div><div class="line">                  }   </div><div class="line"></div><div class="line">                  else if (InnoProString == &quot;STATUS\n&quot;)</div><div class="line">                  {  </div><div class="line">                     Serial.print(InnoProString);</div><div class="line">                     u16TempReadValue = InnoProApp.InnoPro_Telemetry(INNOPRO_READ8);              // Read8, Fault Status</div><div class="line">                     </div><div class="line">                     Serial.print(F(&quot;Status Faults &quot;));                                           // Print the data to serial                      </div><div class="line">                     Serial.print(&quot;\t&quot;);        </div><div class="line">                     Serial.print(F(&quot;HEX: &quot;));             Serial.print(u16TempReadValue,HEX);    // Print Hex Equivalent</div><div class="line">                     Serial.print(&quot;\n&quot;);</div><div class="line">                     Serial.print(&quot;\n&quot;);</div><div class="line"></div><div class="line">                     </div><div class="line">                     //Auto Restart Fault Register   </div><div class="line">                     Serial.print(F(&quot;AUTO RESTART FAULT REGISTERS&quot;));                                                                                                                                         </div><div class="line">                     Serial.print(&quot;\n&quot;); </div><div class="line"></div><div class="line">                     Serial.print(F(&quot;Auto-Restart (AR) Occured &quot;));        bitRead(u16TempReadValue,15) ? ( Serial.print(F(&quot;Yes&quot;)) ) : ( Serial.print(F(&quot;No&quot;)) );     Serial.print(&quot;\n&quot;);                          </div><div class="line">                     Serial.print(F(&quot;IS-pin Short Circuit AR   &quot;));        bitRead(u16TempReadValue,12) ? ( Serial.print(F(&quot;Yes&quot;)) ) : ( Serial.print(F(&quot;No&quot;)) );     Serial.print(&quot;\n&quot;);                                                                 </div><div class="line">                     Serial.print(F(&quot;Output Short Circuit AR   &quot;));        bitRead(u16TempReadValue,11) ? ( Serial.print(F(&quot;Yes&quot;)) ) : ( Serial.print(F(&quot;No&quot;)) );     Serial.print(&quot;\n&quot;);  </div><div class="line">                     Serial.print(F(&quot;Output Voltage OV AR      &quot;));        bitRead(u16TempReadValue,10) ? ( Serial.print(F(&quot;Yes&quot;)) ) : ( Serial.print(F(&quot;No&quot;)) );     Serial.print(&quot;\n&quot;);   </div><div class="line">                     Serial.print(F(&quot;Output Voltage UV AR      &quot;));        bitRead(u16TempReadValue,9)  ? ( Serial.print(F(&quot;Yes&quot;)) ) : ( Serial.print(F(&quot;No&quot;)) );     Serial.print(&quot;\n&quot;);     </div><div class="line">                     Serial.print(&quot;\n&quot;);   </div><div class="line"></div><div class="line"></div><div class="line">                     //Latch Off Fault Register   </div><div class="line">                     Serial.print(F(&quot;LATCH OFF FAULT REGISTERS&quot;));                                                                                                                                         </div><div class="line">                     Serial.print(&quot;\n&quot;);                  </div><div class="line">                                     </div><div class="line">                     Serial.print(F(&quot;Latch-Off (LO) Occured    &quot;));        bitRead(u16TempReadValue,7) ? ( Serial.print(F(&quot;Yes&quot;)) ) : ( Serial.print(F(&quot;No&quot;)) );     Serial.print(&quot;\n&quot;);    </div><div class="line">                     Serial.print(F(&quot;CC Mode LO                &quot;));        bitRead(u16TempReadValue,6) ? ( Serial.print(F(&quot;Yes&quot;)) ) : ( Serial.print(F(&quot;No&quot;)) );     Serial.print(&quot;\n&quot;);                         </div><div class="line">                     Serial.print(F(&quot;PSU Turn-Off CMD Received &quot;));        bitRead(u16TempReadValue,5) ? ( Serial.print(F(&quot;Yes&quot;)) ) : ( Serial.print(F(&quot;No&quot;)) );     Serial.print(&quot;\n&quot;); </div><div class="line">                     Serial.print(F(&quot;IS-pin Short Circuit LO   &quot;));        bitRead(u16TempReadValue,4) ? ( Serial.print(F(&quot;Yes&quot;)) ) : ( Serial.print(F(&quot;No&quot;)) );     Serial.print(&quot;\n&quot;);                                                                 </div><div class="line">                     Serial.print(F(&quot;Output Short Circuit LO   &quot;));        bitRead(u16TempReadValue,3) ? ( Serial.print(F(&quot;Yes&quot;)) ) : ( Serial.print(F(&quot;No&quot;)) );     Serial.print(&quot;\n&quot;);  </div><div class="line">                     Serial.print(F(&quot;Output Voltage OV LO      &quot;));        bitRead(u16TempReadValue,2) ? ( Serial.print(F(&quot;Yes&quot;)) ) : ( Serial.print(F(&quot;No&quot;)) );     Serial.print(&quot;\n&quot;);   </div><div class="line">                     Serial.print(F(&quot;Output Voltage UV LO      &quot;));        bitRead(u16TempReadValue,1) ? ( Serial.print(F(&quot;Yes&quot;)) ) : ( Serial.print(F(&quot;No&quot;)) );     Serial.print(&quot;\n&quot;);   </div><div class="line">                     Serial.print(F(&quot;BPS-pin LO                &quot;));        bitRead(u16TempReadValue,0) ? ( Serial.print(F(&quot;Yes&quot;)) ) : ( Serial.print(F(&quot;No&quot;)) );     Serial.print(&quot;\n&quot;);  </div><div class="line">                                    </div><div class="line">                     //Next Line                        </div><div class="line">                     Serial.print(&quot;\n&quot;);                                                                     </div><div class="line">                  }                                                          </div><div class="line">                  else</div><div class="line">                  {</div><div class="line">                     Serial.print(F(&quot;Invalid&quot;));    </div><div class="line">                     Serial.print(&quot;\n&quot;);                                                                </div><div class="line">                  }</div><div class="line">                  break;</div><div class="line">      </div><div class="line">            case STATE_VOLTS: //Volts</div><div class="line">                  Serial.print(F(&quot;Voltage Setting: &quot;));                  // Print the data to serial         </div><div class="line"></div><div class="line">                  if (isDigit(InnoProString[0]))                         //Check If First Serial Command is a Number</div><div class="line">                  {</div><div class="line">                    inputFloat = InnoProString.toFloat();                //Convert the inputted number to a float     </div><div class="line">                    inputFloat = constrain(inputFloat,3,15);             //Set Limits - 15V for Now , Hardware Limitation</div><div class="line">                    </div><div class="line">                    fTempVolts = inputFloat + 0.001;                     //Store Output Voltage Setting , 1mv Offset Needed for ASCII conversion</div><div class="line">                    Serial.print(inputFloat);                            //Send Value to Serial Monitor                         </div><div class="line">                    Serial.print(F(&quot; V&quot;));                               //Print Unit </div><div class="line">                                  </div><div class="line">                    Serial.print(&quot;\n&quot;);   </div><div class="line">                    SerialState_e = STATE_AMPS;                          //Proceed to Constant Current Setting</div><div class="line">                  }</div><div class="line">                  else</div><div class="line">                  {</div><div class="line">                     Serial.print(F(&quot;Invalid&quot;));    </div><div class="line">                     Serial.print(&quot;\n&quot;);                                                                </div><div class="line">                  }                  </div><div class="line">                  break;      </div><div class="line">      </div><div class="line">            case STATE_AMPS: //Constant Current (Amps)</div><div class="line"></div><div class="line">                  Serial.print(F(&quot;Constant Current Setting: &quot;));         // Print the data to serial </div><div class="line">                   </div><div class="line">                  if (isDigit(InnoProString[0]))                         //Check If First Serial Command is a Number</div><div class="line">                  {</div><div class="line">                    inputFloat = InnoProString.toFloat();                // Convert the inputted number to a float    </div><div class="line">                    inputFloat = constrain(inputFloat,0,6);              //Set Limits: 0 to 6A, depends on Rsense</div><div class="line">                    </div><div class="line">                    fAmps =   inputFloat;                                //Set Constant Current in Amps</div><div class="line">                    Serial.print(inputFloat);                            //Send Value to Serial Monitor</div><div class="line">                    Serial.print(F(&quot; A&quot;));                               //Print Unit                     </div><div class="line"></div><div class="line">                    fVolts = fTempVolts;                                 //Set Output Voltage In Volts</div><div class="line">                    </div><div class="line">                    //Next Line</div><div class="line">                    Serial.print(&quot;\n&quot;);                             </div><div class="line">                    Serial.print(&quot;\n&quot;);        </div><div class="line"></div><div class="line">                    SerialState_e = STATE_CMD_CODE;                      //Return to Inno Pro Command Code</div><div class="line">                  }</div><div class="line">                  else</div><div class="line">                  {</div><div class="line">                     Serial.print(F(&quot;Invalid&quot;));    </div><div class="line">                     Serial.print(&quot;\n&quot;);                                                               </div><div class="line">                  }                                                             </div><div class="line">                  break;     </div><div class="line"></div><div class="line">      </div><div class="line">            case STATE_CDC: //CDC</div><div class="line"></div><div class="line">                  Serial.print(F(&quot;Cable Drop Compensation: &quot;));                </div><div class="line">                   </div><div class="line">                  if (isDigit(InnoProString[0]))                         //Check If First Serial Command is a Number</div><div class="line">                  {</div><div class="line">                    inputFloat = InnoProString.toFloat();        </div><div class="line">                    inputFloat = constrain(inputFloat,0,600);            //Set Limits: 0 to 600mv    </div><div class="line">                    </div><div class="line">                    fCableDropComp =   inputFloat;                       //Set Cable Drop Compensation</div><div class="line">                    Serial.print(inputFloat);                            //Send Value to Serial Monitor  </div><div class="line">                    Serial.print(F(&quot; mV&quot;));                              //Print Unit                               </div><div class="line">                                          </div><div class="line">                    //Next Line</div><div class="line">                    Serial.print(&quot;\n&quot;);                             </div><div class="line">                    Serial.print(&quot;\n&quot;);                        </div><div class="line">             </div><div class="line">                    SerialState_e = STATE_CMD_CODE;                      //Return to Inno Pro Command Code</div><div class="line">                  }</div><div class="line">                  else</div><div class="line">                  {</div><div class="line">                     Serial.print(F(&quot;Invalid&quot;));    </div><div class="line">                     Serial.print(&quot;\n&quot;);                                                                </div><div class="line">                  }                                                             </div><div class="line">                  break;     </div><div class="line"></div><div class="line">      </div><div class="line">            case STATE_VKP: //VKP</div><div class="line"></div><div class="line">                  Serial.print(F(&quot;Constant Output Power Knee Voltage: &quot;));                </div><div class="line">                   </div><div class="line">                  if (isDigit(InnoProString[0]))                         //Check If First Serial Command is a Number</div><div class="line">                  {</div><div class="line">                    inputFloat = InnoProString.toFloat(); </div><div class="line">                    inputFloat = constrain(inputFloat,5.3,24);           //Set Limits: 5.3 to 24V               </div><div class="line">                    </div><div class="line">                    fVoltPeak =   inputFloat;                            //Set Constant Power Knee Voltage</div><div class="line">                    Serial.print(inputFloat);                            //Send Value to Serial Monitor</div><div class="line">                    Serial.print(F(&quot; V&quot;));                               //Print Unit                         </div><div class="line">                                        </div><div class="line">                    //Next Line</div><div class="line">                    Serial.print(&quot;\n&quot;);                             </div><div class="line">                    Serial.print(&quot;\n&quot;);        </div><div class="line">             </div><div class="line">                    SerialState_e = STATE_CMD_CODE;                     //Return to Inno Pro Command Code</div><div class="line">                  }</div><div class="line">                  else</div><div class="line">                  {</div><div class="line">                     Serial.print(F(&quot;Invalid&quot;));    </div><div class="line">                     Serial.print(&quot;\n&quot;);                                                                </div><div class="line">                  }                                                             </div><div class="line">                  break;    </div><div class="line"></div><div class="line">            case STATE_VBEN: //VBEN</div><div class="line"></div><div class="line">                  Serial.print(F(&quot;Series Bus Switch Control: &quot;));                </div><div class="line">                   </div><div class="line">                  if (isDigit(InnoProString[0]))                         //Check If First Serial Command is a Number</div><div class="line">                  {</div><div class="line">                    inputFloat = InnoProString.toFloat();    </div><div class="line">                    inputFloat = constrain(inputFloat,0,1);              //Set Limits - 1 or 0 Only             </div><div class="line"></div><div class="line">                    InnoProApp.InnoPro_Initialization();                 //Re- Initialize to Disable Watchdog                            </div><div class="line">                    fVbusEn =   inputFloat;                              //Set VBEN Value</div><div class="line">                                         </div><div class="line">                    Serial.print(inputFloat);                            //Send Value to Serial Monitor</div><div class="line"></div><div class="line">                    //Analyze and Print VBEN Setting</div><div class="line">                    if(inputFloat == 0)</div><div class="line">                    {</div><div class="line">                       Serial.print(F(&quot; OFF&quot;));                          //Print Setting                          </div><div class="line">                    }</div><div class="line">                    else if( inputFloat &gt;= 1)</div><div class="line">                    {</div><div class="line">                       Serial.print(F(&quot; ON&quot;));                           //Print Setting                 </div><div class="line">                    }</div><div class="line">                    else</div><div class="line">                    {</div><div class="line">                       Serial.print(F(&quot; OFF&quot;));                          //Print Setting    </div><div class="line">                    }</div><div class="line"></div><div class="line">                    //Next Line</div><div class="line">                    Serial.print(&quot;\n&quot;);                             </div><div class="line">                    Serial.print(&quot;\n&quot;);    </div><div class="line">            </div><div class="line">                    SerialState_e = STATE_CMD_CODE;                      //Return to Inno Pro Command Code</div><div class="line">                  }</div><div class="line">                  else</div><div class="line">                  {</div><div class="line">                     Serial.print(F(&quot;Invalid&quot;));    </div><div class="line">                     Serial.print(&quot;\n&quot;);                                                               </div><div class="line">                  }                                                             </div><div class="line">                  break;                                                                    </div><div class="line"></div><div class="line">          }</div><div class="line">}</div><div class="line"></div><div class="line"></div></div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
